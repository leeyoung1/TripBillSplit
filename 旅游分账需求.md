# 🧳 旅游分账App需求文档

## 📋 项目概述

### 项目名称
旅游分账App - AI智能记账系统

### 项目定位
面向18-35岁年轻群体的智能化旅游消费分账应用，通过AI技术解决传统记账痛点，实现"账单同步 + AI识票 + 智能分析"的完整解决方案。

### 核心价值主张
- **从"填写"到"选择"** - AI智能推测，用户确认即可
- **从"手动"到"自动"** - 账单自动同步，告别遗忘
- **从"复杂"到"简单"** - 拍照识别，秒速记账
- **从"依赖小票"到"无需小票"** - 路边摊、小商贩场景完美覆盖

---

## 🎯 用户画像与痛点分析

### 目标用户
- **年龄段**: 18-35岁
- **职业**: 学生、白领、自由职业者
- **收入**: 月收入3000-15000元
- **特点**: 喜欢旅行、注重效率、习惯移动支付

### 核心痛点

#### 1. 💸 付款时的记账困扰
- **痛点**: 付款时匆忙，不想当场记账
- **影响**: 事后忘记消费详情，记账困难
- **频率**: 旅行中每次消费都会遇到

#### 2. 📝 手动记账繁琐易错
- **痛点**: 需要逐一填写金额、分类、参与人员
- **影响**: 耗时长、容易出错、体验差
- **频率**: 每次记账都需要重复操作

#### 3. 👥 参与人员分配复杂
- **痛点**: 不知道谁参与了哪些消费，分账逻辑复杂
- **影响**: 容易产生纠纷，结算困难
- **频率**: 有部分成员参与的消费场景

#### 4. 🔄 数据同步和遗漏
- **痛点**: 容易遗漏消费记录，数据不同步
- **影响**: 账目不清晰，结算时发现问题
- **频率**: 旅行结束后结算时发现

---

## ✨ 解决方案与功能设计

### 🔄 核心功能1：智能账单同步

#### 功能描述
自动同步支付宝、微信支付、银行卡等第三方平台的交易记录，AI智能筛选旅行相关消费。

#### 功能特性
- **多平台支持**: 支付宝、微信支付、银行卡
- **实时同步**: 每30分钟自动检查新交易
- **智能筛选**: AI识别旅行相关消费
- **安全保障**: 银行级加密，只读取交易信息
- **用户控制**: 支持手动同步和自定义筛选规则

#### 用户流程
1. 用户快速付款（支付宝/微信）
2. 系统后台自动同步交易记录
3. AI智能判断是否为旅行消费
4. 用户后续打开App时看到待添加的消费
5. 一键确认添加到对应旅行

#### 技术实现
- 第三方支付平台API接入
- AI消费类型识别算法
- 数据安全加密传输

---

### 🤖 核心功能2：AI小票识别

#### 功能描述
通过拍照上传小票，AI自动识别并提取商户名称、消费金额、消费时间、商品明细等信息。

#### 功能特性
- **智能拍照**: 现场拍摄或相册选择
- **精准识别**: OCR + AI算法，准确率95%+
- **秒速处理**: 3秒内完成识别
- **信息提取**: 商户、金额、时间、支付方式、商品明细
- **可编辑确认**: 支持手动调整识别结果

#### 识别内容
- 商户名称
- 消费金额（总计）
- 消费时间
- 支付方式
- 商品明细（名称、单价、数量）
- 消费分类（餐饮、住宿、交通等）

#### 技术实现
- OCR文字识别技术
- NLP自然语言处理
- 机器学习分类算法
- 图像预处理优化

---

### 🎙️ 核心功能2B：AI无小票智能识别

#### 应用场景
针对路边小店、街边摊、小商贩等无法提供正式小票的消费场景，通过AI多维度信息推测，实现智能化选择式录入。

#### 功能描述
当用户无法获得小票时，AI基于多重信息源（位置、时间、金额、语音等）智能推测消费详情，生成精准的选择项供用户确认。

#### 智能推测维度

##### 1. 地理位置智能推测
- **景区周边**: 自动推测为门票、纪念品、小食
- **餐饮聚集区**: 推测为餐饮消费，根据时间细分早/中/晚餐
- **交通枢纽**: 推测为交通费用、行李寄存等
- **商业街区**: 推测为购物、娱乐消费
- **酒店周边**: 推测为住宿相关消费

##### 2. 时间场景智能推测
- **07:00-10:00**: 推测为早餐，提供"包子/豆浆/油条"等选项
- **11:30-14:00**: 推测为午餐，根据金额推测人数和菜品类型
- **17:30-21:00**: 推测为晚餐，提供丰富的晚餐选项
- **21:00-24:00**: 推测为夜宵、酒吧、KTV等娱乐消费

##### 3. 金额范围智能推测
- **¥5-20**: 小食、饮料、零食类，推测个人消费
- **¥20-100**: 简餐、快餐，推测1-2人消费
- **¥100-300**: 正餐，推测2-4人消费
- **¥300+**: 大餐或团体消费，推测全员参与

##### 4. 语音描述AI理解
- **用户说**: "刚才买了些水果"
- **AI推测**: 消费类型→购物，商品→水果，参与人员→推测分享情况
- **生成选择**: "苹果¥30"、"全员分享"、"个人消费"等选项

#### 智能选择项生成

##### 场景示例1：路边水果摊
```
🔍 AI智能推测
📍 位置：天涯海角景区门口
⏰ 时间：15:30 下午
💰 金额：¥45
🎤 语音："买了点椰子"

🤖 AI生成选择项：
┌─────────────────────┐
│ 消费类型：购物 > 水果    │
│ 商品推测：椰子          │
│ 数量选择：              │
│ ○ 3个椰子 (¥15/个)     │
│ ○ 4个椰子 (¥11/个)     │ ✓ 推荐
│ ○ 5个椰子 (¥9/个)      │
│                        │
│ 参与人员：4人旅行       │
│ ○ 全员分享 (¥11.25/人) │ ✓ 推荐
│ ○ 部分分享 (选择人员)   │
│ ○ 个人消费             │
└─────────────────────┘
```

##### 场景示例2：小面店无小票
```
🔍 AI智能推测
📍 位置：南山文化旅游区附近
⏰ 时间：12:20 午餐时间
💰 金额：¥85
🎤 语音："吃了个面"

🤖 AI生成选择项：
┌─────────────────────┐
│ 消费类型：餐饮 > 午餐    │
│ 商品推测：面条          │
│ 份数选择：              │
│ ○ 2碗面 (¥42.5/碗)    │ ✓ 推荐
│ ○ 3碗面 (¥28/碗)      │
│ ○ 自定义               │
│                        │
│ 参与人员：4人旅行       │
│ ○ 2人用餐 (¥42.5/人)  │ ✓ 推荐
│ ○ 3人用餐 (¥28/人)    │
│ ○ 全员用餐 (¥21/人)   │
└─────────────────────┘
```

##### 场景示例3：街边小吃
```
🔍 AI智能推测
📍 位置：第一市场美食街
⏰ 时间：20:30 夜宵时间
💰 金额：¥120
📸 拍照：烧烤摊位

🤖 AI生成选择项：
┌─────────────────────┐
│ 消费类型：餐饮 > 夜宵    │
│ 商品推测：烧烤          │
│ 内容选择：              │
│ ○ 烧烤拼盘 (4人份)     │ ✓ 推荐
│ ○ 海鲜烧烤 (团体)      │
│ ○ 自定义描述           │
│                        │
│ 参与人员：4人旅行       │
│ ○ 全员参与 (¥30/人)   │ ✓ 推荐
│ ○ 部分参与 (选择人员)   │
└─────────────────────┘
```

#### 快速录入模式

##### 模式1：一句话录入
- **用户操作**: 点击语音按钮，说"刚才买了4个椰子，45块钱"
- **AI处理**: 提取关键信息→商品、数量、金额
- **自动生成**: 消费记录 + 推荐分账方案
- **用户确认**: 一键确认或微调

##### 模式2：拍照 + 语音
- **用户操作**: 拍摄商店/商品照片 + 简单语音描述
- **AI分析**: 图像识别商店类型 + 语音理解消费内容
- **智能推测**: 结合位置、时间生成详细选择项
- **快速确认**: 用户选择最符合的方案

##### 模式3：极简手动
```
📱 极简录入界面
┌─────────────────────┐
│ 💰 金额：¥_____      │
│ 🏪 类型：[智能推测]   │
│ 👥 人员：[智能推测]   │
│                     │
│ [确认添加]           │
└─────────────────────┘

输入金额后，AI自动推测：
- 根据当前位置推测消费类型
- 根据金额和旅行人数推测参与人员
- 用户只需确认或微调
```

#### AI推理逻辑

##### 第一步：场景识别
1. **GPS定位** → 识别周边商业类型
2. **时间分析** → 判断消费场景(餐饮/购物/娱乐)
3. **金额范围** → 推测消费规模和可能的商品

##### 第二步：内容推测
1. **语音理解** → NLP提取关键词(商品、数量、特征)
2. **图像识别** → 识别商店类型、商品类别
3. **历史学习** → 基于用户历史消费习惯

##### 第三步：智能生成
1. **选择项生成** → 提供2-3个最可能的选项
2. **参与人员推测** → 基于金额和商品类型推测
3. **置信度排序** → 将最可能的选项排在前面

#### 技术实现

##### AI技术栈
- **语音识别**: 科大讯飞/百度语音 + 自然语言理解
- **图像识别**: 商店类型识别 + 商品类别识别
- **地理信息**: 高德/百度地图API + POI分析
- **推理引擎**: 规则引擎 + 机器学习模型

##### 数据支撑
- **地理位置数据库**: 各类商业场所的消费特征库
- **时间场景数据库**: 不同时间段的消费模式
- **金额区间数据库**: 各类消费的典型金额范围
- **用户行为数据**: 个人消费习惯和偏好

#### 用户体验优势

##### 相比传统手动输入
- **输入减少90%**: 从填写6-8个字段减少到确认1-2个选择
- **时间节省80%**: 从2-3分钟减少到30秒内完成
- **错误减少95%**: AI智能推测，避免手动输入错误

##### 相比其他记账应用
- **无需小票依赖**: 路边摊、小商贩场景完全覆盖
- **智能化程度高**: 不是简单模板，而是AI理解和推测
- **选择式交互**: 符合用户"不想填写，只想选择"的需求

---

### 🧠 核心功能3：AI智能参与分析

#### 功能描述
基于消费明细和旅行人数，AI智能分析参与人员，从"用户填写"变为"用户选择"。

#### 智能分析场景

##### 场景1：数量不匹配
- **示例**: 6人旅行，买了5个苹果、5瓶水
- **AI推理**: 可能有1人没参与此消费
- **处理方式**: 提示选择未参与的成员
- **结果**: 按实际参与人数分摊

##### 场景2：数量明显不足
- **示例**: 4人旅行，只点了2个菜、2份米饭
- **AI推理**: 只有部分成员参与用餐
- **处理方式**: 询问并选择参与成员
- **结果**: 灵活分配实际用餐人员

##### 场景3：数量超出
- **示例**: 4人旅行，买了6个冰淇淋
- **AI推理**: 可能有人多买了或代买了
- **处理方式**: 提供多种分配方案
- **结果**: 用户选择最合适的方式

##### 场景4：数量匹配
- **示例**: 4人旅行，4张门票
- **AI推理**: 数量完美匹配，全员参与
- **处理方式**: 自动平分
- **结果**: 无需用户干预，直接确认

#### AI推理算法
1. **识别商品类型**: 个人消费品 vs 共享消费品
2. **数量对比分析**: 计算商品数量与旅行人数差异
3. **场景智能判断**: 推测最可能的消费场景
4. **生成分账建议**: 提供最优分账方案

#### 技术实现
- 商品分类算法
- 数量匹配分析
- 消费场景推理模型
- 多方案生成算法

---

## 📱 基础功能模块

### 1. 旅行管理
- **创建旅行**: 设置名称、时间、预算、封面
- **成员邀请**: 二维码、链接分享
- **权限管理**: 管理员、成员权限设置
- **旅行设置**: 编辑信息、结束旅行

### 2. 消费记账
- **手动记账**: 传统表单填写方式
- **智能记账**: AI识别 + 账单同步
- **消费分类**: 餐饮、住宿、交通、娱乐、购物、其他
- **分账方式**: 平均分账、按比例、按金额

### 3. 分账计算
- **实时计算**: 每笔消费自动计算分账
- **详细分析**: 每个成员的支付、应分摊、差额
- **最优结算**: 最少转账次数的结算方案
- **历史记录**: 完整的消费和分账记录

### 4. 结算支付
- **支付方式**: 支付宝、微信、银行卡
- **安全确认**: 订单详情、安全提示
- **支付状态**: 实时更新支付状态
- **结算完成**: 自动更新账目状态

### 5. 用户管理
- **个人信息**: 头像、昵称、统计数据
- **消费统计**: 总消费、待结算、已结清
- **历史记录**: 参与旅行、消费记录
- **设置中心**: 支付、通知、隐私设置

---

## 🎨 设计规范

### 视觉设计
- **设计风格**: iOS设计规范，现代简约
- **主色调**: #007AFF (iOS蓝)
- **辅助色彩**: 成功绿#34C759、警告橙#FF9500、危险红#FF3B30
- **字体系统**: iOS系统字体，12px-32px八级层次
- **圆角规范**: 6px、8px、12px、16px四级圆角

### 交互设计
- **导航模式**: 底部Tab导航 + 顶部导航栏
- **操作反馈**: 触感反馈、动画过渡、状态提示
- **空状态**: 友好的空状态引导
- **加载状态**: 骨架屏、进度条、加载动画

### 设备适配
- **主要设备**: iPhone 15 Pro (393×852px)
- **兼容设备**: iPhone 14/13/12、iPhone SE
- **响应式**: 支持不同屏幕尺寸自适应

---

## 🚀 技术架构

### 前端技术
- **框架**: React Native / Flutter
- **UI库**: 自定义组件库 + iOS原生组件
- **状态管理**: Redux / MobX
- **网络请求**: Axios + 请求拦截器
- **本地存储**: AsyncStorage + 数据加密

### 后端技术
- **服务端**: Node.js + Express / Python + Django
- **数据库**: MySQL + Redis
- **文件存储**: 阿里云OSS / 腾讯云COS
- **消息队列**: Redis / RabbitMQ

### AI技术栈
- **OCR识别**: 百度AI / 腾讯AI / 阿里云AI
- **图像处理**: OpenCV + PIL
- **NLP处理**: jieba分词 + 自定义规则
- **机器学习**: TensorFlow / PyTorch

### 第三方集成
- **支付**: 支付宝SDK、微信支付SDK
- **推送**: 极光推送 / 个推
- **统计**: 友盟统计 / 神策数据
- **监控**: Sentry / Bugly

---

## 📊 数据设计

### 核心数据表

#### 用户表 (users)
- user_id, nickname, avatar, phone, created_at
- payment_alipay, payment_wechat, payment_bank

#### 旅行表 (trips)
- trip_id, name, description, start_date, end_date
- budget, cover_image, status, creator_id, created_at

#### 旅行成员表 (trip_members)
- member_id, trip_id, user_id, role, permissions
- joined_at, status

#### 消费记录表 (expenses)
- expense_id, trip_id, payer_id, amount, description
- category, payment_method, expense_time, created_at
- ai_source, receipt_image, raw_data

#### 分账记录表 (expense_splits)
- split_id, expense_id, user_id, amount
- split_type, status, created_at

#### 结算记录表 (settlements)
- settlement_id, trip_id, from_user_id, to_user_id
- amount, status, payment_method, created_at

### 数据流设计
1. **消费录入** → AI识别/手动输入 → 生成消费记录
2. **智能分析** → 推测参与人员 → 生成分账记录
3. **实时计算** → 更新每人欠款状态 → 生成结算建议
4. **支付结算** → 确认转账 → 更新账目状态

---

## 🔒 安全与隐私

### 数据安全
- **传输加密**: HTTPS + TLS 1.3
- **存储加密**: AES-256数据库加密
- **访问控制**: JWT Token + 权限验证
- **敏感信息**: 支付密码不存储，仅读取交易记录

### 隐私保护
- **数据最小化**: 只收集必要的业务数据
- **用户授权**: 明确的隐私政策和授权流程
- **数据删除**: 用户可删除个人数据
- **第三方**: 严格控制第三方数据访问

### 合规要求
- **个人信息保护法**: 符合中国《个人信息保护法》
- **网络安全法**: 数据本地化存储
- **支付安全**: 符合央行支付安全规范

---

## 📈 运营策略

### 用户获取
- **社交推广**: 朋友邀请奖励机制
- **内容营销**: 旅行攻略 + 分账技巧
- **合作推广**: 与旅行平台、酒店合作
- **应用商店**: ASO优化，提升搜索排名

### 用户留存
- **功能价值**: 持续优化核心功能体验
- **社交属性**: 旅行群组、消费透明化
- **数据价值**: 个人消费分析报告
- **习惯培养**: 消费提醒、定期总结

### 商业模式
- **免费增值**: 基础功能免费，高级功能付费
- **会员服务**: 月费/年费会员，享受更多权益
- **数据服务**: 为商户提供消费数据分析（匿名化）
- **广告合作**: 精准的旅游相关广告投放

---

## 🎯 产品路线图

### V1.0 MVP版本（3个月）
- ✅ 基础旅行创建和成员管理
- ✅ 手动消费记账功能
- ✅ 简单分账计算
- ✅ 基础结算功能

### V2.0 智能化版本（6个月）
- ✅ AI小票识别功能
- ✅ 账单同步功能
- ✅ 智能参与分析
- ✅ 优化用户体验

### V3.0 增强版本（9个月）
- 🔄 更多支付平台接入
- 🔄 智能消费预算提醒
- 🔄 消费数据可视化分析
- 🔄 多语言支持

### V4.0 生态版本（12个月）
- 🔄 商户合作（直接分账）
- 🔄 信用体系建设
- 🔄 社交功能增强
- 🔄 开放平台API

---

## 📏 成功指标

### 用户指标
- **新用户获取**: 月新增用户数
- **用户活跃**: DAU、MAU、用户留存率
- **功能使用**: AI识别使用率、同步功能使用率
- **用户满意度**: App Store评分、NPS得分

### 业务指标
- **交易规模**: 月处理交易金额
- **效率提升**: 记账时间减少比例
- **准确性**: AI识别准确率、分账争议率
- **完成率**: 旅行结算完成率

### 技术指标
- **系统稳定性**: 服务可用性99.9%+
- **响应速度**: API响应时间<500ms
- **识别速度**: AI识别时间<3秒
- **同步及时性**: 账单同步延迟<30分钟

---

## 🔧 开发计划

### 人员配置
- **产品经理**: 1人，负责需求分析和产品设计
- **UI设计师**: 1人，负责界面设计和交互设计
- **前端开发**: 2人，负责移动端开发
- **后端开发**: 2人，负责服务端开发
- **AI工程师**: 1人，负责AI算法开发
- **测试工程师**: 1人，负责功能测试和自动化测试

### 开发周期
- **需求分析**: 2周
- **原型设计**: 2周
- **UI设计**: 3周
- **前端开发**: 8周
- **后端开发**: 8周
- **AI算法开发**: 6周
- **集成测试**: 4周
- **上线准备**: 2周

### 质量保证
- **代码审查**: 所有代码必须经过Review
- **自动化测试**: 单元测试覆盖率>80%
- **性能测试**: 压力测试和性能优化
- **安全测试**: 渗透测试和安全加固

---

## 📝 附录

### 竞品分析
- **Splitwise**: 国外主流分账应用，功能完善但无AI
- **AA记账**: 国内分账应用，界面简洁但功能基础
- **趣记账**: 记账类应用，有一定的分账功能

### 用户反馈
- 期望功能：语音记账、位置自动识别、消费预算提醒
- 痛点反馈：手动记账太麻烦、容易忘记、分账计算复杂
- 体验建议：界面要简洁、操作要快速、数据要准确

### 技术调研
- AI识别技术成熟度高，准确率可达95%+
- 第三方支付API接入技术可行
- 移动端开发框架选择React Native或Flutter
- 云服务选择阿里云或腾讯云

---

**文档版本**: V1.0  
**创建日期**: 2024年12月20日  
**最后更新**: 2024年12月20日  
**负责人**: 产品团队 